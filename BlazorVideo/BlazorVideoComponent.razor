@namespace BlazorVideo
@inherits BlazorVideoComponentBase

@using System

<style type="text/css">

    .video-item-@(Id + ConnectionId) {
        line-height: 14px;
    }

    .video-item-@(Id + ConnectionId) .video-item-devices {
        display: none;
    }

    .video-item-resize-container-@(Id + ConnectionId) {
        width: 240px;
        height: 180px;
        resize: both;
        overflow: hidden;
        background-color: @BackgroundColor;
    }

    .video-item-resize-container:hover .video-ellipsis {
        display: initial;
    }

    .video-item-ellipsis {
        text-overflow: ellipsis;
        overflow: hidden;
        white-space: nowrap;
        z-index: 1;
        display: initial;
    }

    .background-gradient-blue {
        background-image: linear-gradient(to bottom, rgba(255,255,255,1), rgba(49,94,182,1));
    }

    .background-gradient-red {
        background-image: linear-gradient(to bottom, rgba(255,255,255,1), rgba(182,94,49,1));
    }

</style>

<div class="video-item-@(Id + ConnectionId) p-1">

    @if (Type == BlazorVideoType.LocalLivestream)
    {
        if(BlazorVideoService.BlazorVideoMaps.Any(item => item.Value.Id == Id && item.Value.ConnectionId == ConnectionId && item.Value.VideoOverlay == false)) {

            <style type="text/css">
                .video-item-@(Id + ConnectionId):hover .video-item-devices {
                    display: block;
                }
            </style>
        }

        <div>
            <div class="video-item-resize-container-@(Id + ConnectionId) position-relative">
                <div class="align-items-center justify-content-center px-3 h-100 @(BlazorVideoService.BlazorVideoMaps.Any(item => item.Value.Id == Id && item.Value.ConnectionId == ConnectionId && item.Value.VideoOverlay == true) ? "d-flex" : "d-none")">
                    <button class="btn btn-lg btn-link text-white bg-dark p-sm-2" type="button" @onclick="async () => await BlazorVideoService.StartVideoChat(Id, ConnectionId)">

                        ▷ @Name

                    </button>
                </div>

                <div class="w-100 h-100 @(!BlazorVideoService.BlazorVideoMaps.Any(item => item.Value.Id == Id && item.Value.ConnectionId == ConnectionId) ? "d-none" : "d-block")">
                    
                    <div class="text-white px-2 py-2 mb-0 position-absolute video-item-ellipsis">
                        <small>[loc.] @Name</small>
                    </div>
                    <video id="local-livestream-element-id-@(Id + ConnectionId)" class="blazor-video-item mb-0 w-100 h-100" controls></video>

                    <div class="position-absolute video-item-devices bg-white p-1" style="z-index: 2; right: 0px; top: 0px;">
                        <div class="input-group" style="padding: 0.125rem 0.25rem 0.1rem 0.25rem">
                            <select id="local-livestream-micro-source-@(Id + ConnectionId)" class="border-0 custom-select custom-select-sm" style="width: 120px !important;"></select>
                        </div>
                        <div class="input-group" style="padding: 0.125rem 0.25rem 0.1rem 0.25rem">
                            <select id="local-livestream-audio-source-@(Id + ConnectionId)" class="border-0 custom-select custom-select-sm" style="width: 120px !important;"></select>
                        </div>
                        <div class="input-group" style="padding: 0.125rem 0.25rem 0.1rem 0.25rem">
                            <select id="local-livestream-video-source-@(Id + ConnectionId)" class="border-0 custom-select custom-select-sm" style="width: 120px !important;"></select>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    }

    @if (Type == BlazorVideoType.RemoteLivestream)
    {
        <div>
            <div class="video-item-resize-container-@(Id + ConnectionId) position-relative">

                <div class="align-items-center justify-content-center px-3 h-100 @(BlazorVideoService.BlazorVideoMaps.Any(item => item.Value.Id == Id && item.Value.ConnectionId == ConnectionId && item.Value.VideoOverlay == true) ? "d-flex" : "d-none")">
                    <button class="btn btn-lg btn-link text-white bg-dark p-sm-2" type="button" @onclick="async () => await BlazorVideoService.StartVideoChat(Id, ConnectionId)">

                        @if (Status == BlazorVideoStatusType.Live)
                        {
                            <span class="oi oi-media-play text-danger"></span> @Name
                        }
                        @if (Status == BlazorVideoStatusType.Offline)
                        {
                            <span class="oi oi-media-pause text-info"></span> @Name
                        }

                    </button>
                </div>

                <div class="w-100 h-100 @(!BlazorVideoService.BlazorVideoMaps.Any(item => item.Value.Id == Id && item.Value.ConnectionId == ConnectionId) ? "d-none" : "d-block")">
                    <div class="text-white px-2 py-2 mb-0 position-absolute video-item-ellipsis">
                        <small>[rem.] @Name</small>
                    </div>
                    <video id="remote-livestream-element-id-@(Id + ConnectionId)" class="blazor-video-item mb-0 w-100 h-100" controls></video>
                </div>

            </div>
        </div>
    }

</div>

@code {

}
